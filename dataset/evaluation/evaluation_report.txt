================================================================================
ENHANCED EVALUATION REPORT
Ground Truth vs Predicted OTU Comparison (Multi-Level)
Using Shared taxonomy_parser.py for consistent parsing
Supports Multiple Ground Truth Files
================================================================================

GROUND TRUTH SOURCES
--------------------------------------------------------------------------------
Number of ground truth files: 4
  - ssu_accession_full_lineage.tsv
  - LSU_eukaryote_rRNA_accession_full_lineage.tsv
  - ITS_eukaryote_sequences_accession_full_lineage.tsv
  - 16S_ribosomal_RNA_accession_full_lineage.tsv

Records by source:
  ITS_eukaryote_sequences_accession_full_lineage.tsv: 65,678
  16S_ribosomal_RNA_accession_full_lineage.tsv: 21,278
  ssu_accession_full_lineage.tsv: 7,951
  LSU_eukaryote_rRNA_accession_full_lineage.tsv: 6,574

DATASET OVERVIEW
--------------------------------------------------------------------------------
Total sequences: 120,295
Sequences with ground truth: 101,481
Sequences without ground truth (N/A): 18,814
Total clusters: 28142
Noise sequences (cluster -1): 35,438

================================================================================
1. ACCURACY AT TAXONOMIC LEVELS
================================================================================

DOMAIN Level:
  Total sequences evaluated: 62,888
  Correct predictions: 62,279
  Incorrect predictions: 609
  Accuracy: 99.03%

KINGDOM Level:
  Total sequences evaluated: 62,424
  Correct predictions: 55,647
  Incorrect predictions: 6,777
  Accuracy: 89.14%

PHYLUM Level:
  Total sequences evaluated: 62,247
  Correct predictions: 53,057
  Incorrect predictions: 9,190
  Accuracy: 85.24%

CLASS Level:
  Total sequences evaluated: 62,266
  Correct predictions: 49,394
  Incorrect predictions: 12,872
  Accuracy: 79.33%

ORDER Level:
  Total sequences evaluated: 61,955
  Correct predictions: 36,337
  Incorrect predictions: 25,618
  Accuracy: 58.65%

FAMILY Level:
  Total sequences evaluated: 62,075
  Correct predictions: 33,621
  Incorrect predictions: 28,454
  Accuracy: 54.16%

GENUS Level:
  Total sequences evaluated: 70,901
  Correct predictions: 33,136
  Incorrect predictions: 37,765
  Accuracy: 46.74%

SPECIES Level:
  Total sequences evaluated: 70,901
  Correct predictions: 23,451
  Incorrect predictions: 47,450
  Accuracy: 33.08%

================================================================================
2. NOVELTY DETECTION PERFORMANCE
================================================================================

True Positives (Novel→Novel): 5,000
False Positives (Known→Novel): 30,580
True Negatives (Known→Known, correct genus): 33,136
False Negatives (Novel→Known): 13,814

Precision: 0.141
Recall: 0.266
F1-Score: 0.184
Accuracy: 0.317

================================================================================
3. CLUSTER QUALITY (TAXONOMIC PURITY)
================================================================================

Purity calculated at genus level
Clusters evaluated: 27211
Mean purity: 0.594
Median purity: 0.500
High purity clusters (>0.9): 7397
Medium purity clusters (0.7-0.9): 418
Low purity clusters (<0.7): 19396

================================================================================
4. MISCLASSIFICATION ANALYSIS
================================================================================

Analysis at genus level
Total sequences evaluated: 70,901
Total misclassified: 37,765
Misclassification rate: 53.26%

Top 10 misclassification patterns (Genus level):
  Phlegmacium -> Cortinarius: 30
  Cortinarius -> Phlegmacium: 23
  Aspergillus -> Penicillium: 19
  Penicillium -> Aspergillus: 19
  Cortinarius -> Inocybe: 18
  Cortinarius -> Thaxterogaster: 17
  Solanum -> Camellia: 17
  Amblyomma -> Bothriocroton: 16
  Inocybe -> Cortinarius: 12
  Cortinarius -> Calonarius: 11

================================================================================
5. OVERALL ASSESSMENT
================================================================================

Genus Accuracy: 46.74%
Species Accuracy: 33.08%
Novelty Detection F1-Score: 0.184
Cluster Purity (Mean, Genus): 0.594

Overall Rating: POOR: Low performance, significant improvements needed

================================================================================
6. RECOMMENDATIONS
================================================================================

- Species accuracy is low. Check `master_evaluation_table.csv` for common errors.
- Tune novelty detection thresholds (identity_threshold_novel)
- Review False Positives (Known→Novel) and False Negatives (Novel→Known)
- Adjust clustering parameters (min_cluster_size, min_samples)
- Consider alternative distance metrics or dimensionality reduction
