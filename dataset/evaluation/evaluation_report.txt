================================================================================
ENHANCED EVALUATION REPORT
Ground Truth vs Predicted OTU Comparison (Multi-Level)
Using Shared taxonomy_parser.py for consistent parsing
Supports Multiple Ground Truth Files
================================================================================

GROUND TRUTH SOURCES
--------------------------------------------------------------------------------
Number of ground truth files: 4
  - ssu_accession_full_lineage.tsv
  - LSU_eukaryote_rRNA_accession_full_lineage.tsv
  - ITS_eukaryote_sequences_accession_full_lineage.tsv
  - 16S_ribosomal_RNA_accession_full_lineage.tsv

Records by source:
  ITS_eukaryote_sequences_accession_full_lineage.tsv: 65,678
  16S_ribosomal_RNA_accession_full_lineage.tsv: 21,278
  ssu_accession_full_lineage.tsv: 7,951
  LSU_eukaryote_rRNA_accession_full_lineage.tsv: 6,574

DATASET OVERVIEW
--------------------------------------------------------------------------------
Total sequences: 120,295
Sequences with ground truth: 101,481
Sequences without ground truth (N/A): 18,814
Total clusters: 25149
Noise sequences (cluster -1): 18,187

================================================================================
1. ACCURACY AT TAXONOMIC LEVELS
================================================================================

DOMAIN Level:
  Total sequences evaluated: 74,910
  Correct predictions: 74,592
  Incorrect predictions: 318
  Accuracy: 99.58%

KINGDOM Level:
  Total sequences evaluated: 74,504
  Correct predictions: 68,009
  Incorrect predictions: 6,495
  Accuracy: 91.28%

PHYLUM Level:
  Total sequences evaluated: 74,409
  Correct predictions: 65,484
  Incorrect predictions: 8,925
  Accuracy: 88.01%

CLASS Level:
  Total sequences evaluated: 74,310
  Correct predictions: 60,697
  Incorrect predictions: 13,613
  Accuracy: 81.68%

ORDER Level:
  Total sequences evaluated: 74,027
  Correct predictions: 42,280
  Incorrect predictions: 31,747
  Accuracy: 57.11%

FAMILY Level:
  Total sequences evaluated: 74,067
  Correct predictions: 38,528
  Incorrect predictions: 35,539
  Accuracy: 52.02%

GENUS Level:
  Total sequences evaluated: 85,497
  Correct predictions: 36,324
  Incorrect predictions: 49,173
  Accuracy: 42.49%

SPECIES Level:
  Total sequences evaluated: 85,497
  Correct predictions: 21,069
  Incorrect predictions: 64,428
  Accuracy: 24.64%

================================================================================
2. NOVELTY DETECTION PERFORMANCE
================================================================================

True Positives (Novel→Novel): 2,340
False Positives (Known→Novel): 15,984
True Negatives (Known→Known, correct genus): 36,324
False Negatives (Novel→Known): 16,474

Precision: 0.128
Recall: 0.124
F1-Score: 0.126
Accuracy: 0.321

================================================================================
3. CLUSTER QUALITY (TAXONOMIC PURITY)
================================================================================

Purity calculated at genus level
Clusters evaluated: 24325
Mean purity: 0.578
Median purity: 0.500
High purity clusters (>0.9): 6603
Medium purity clusters (0.7-0.9): 748
Low purity clusters (<0.7): 16974

================================================================================
4. MISCLASSIFICATION ANALYSIS
================================================================================

Analysis at genus level
Total sequences evaluated: 85,497
Total misclassified: 49,173
Misclassification rate: 57.51%

Top 10 misclassification patterns (Genus level):
  Inocybe -> Cortinarius: 53
  Phlegmacium -> Cortinarius: 40
  Aspergillus -> Penicillium: 39
  Cortinarius -> Phlegmacium: 38
  Amanita -> Cortinarius: 23
  Penicillium -> Aspergillus: 22
  Cortinarius -> Thaxterogaster: 20
  Amblyomma -> Bothriocroton: 19
  Entoloma -> Cortinarius: 19
  Thaxterogaster -> Cortinarius: 18

================================================================================
5. OVERALL ASSESSMENT
================================================================================

Genus Accuracy: 42.49%
Species Accuracy: 24.64%
Novelty Detection F1-Score: 0.126
Cluster Purity (Mean, Genus): 0.578

Overall Rating: POOR: Low performance, significant improvements needed

================================================================================
6. RECOMMENDATIONS
================================================================================

- Species accuracy is low. Check `master_evaluation_table.csv` for common errors.
- Tune novelty detection thresholds (identity_threshold_novel)
- Review False Positives (Known→Novel) and False Negatives (Novel→Known)
- Adjust clustering parameters (min_cluster_size, min_samples)
- Consider alternative distance metrics or dimensionality reduction
