================================================================================
ENHANCED EVALUATION REPORT
Ground Truth vs Predicted OTU Comparison (Multi-Level)
Using Shared taxonomy_parser.py for consistent parsing
Supports Multiple Ground Truth Files
================================================================================

GROUND TRUTH SOURCES
--------------------------------------------------------------------------------
Number of ground truth files: 4
  - ssu_accession_full_lineage.tsv
  - LSU_eukaryote_rRNA_accession_full_lineage.tsv
  - ITS_eukaryote_sequences_accession_full_lineage.tsv
  - 16S_ribosomal_RNA_accession_full_lineage.tsv

Records by source:
  ITS_eukaryote_sequences_accession_full_lineage.tsv: 65,678
  16S_ribosomal_RNA_accession_full_lineage.tsv: 21,278
  ssu_accession_full_lineage.tsv: 7,951
  LSU_eukaryote_rRNA_accession_full_lineage.tsv: 6,574

DATASET OVERVIEW
--------------------------------------------------------------------------------
Total sequences: 120,295
Sequences with ground truth: 101,481
Sequences without ground truth (N/A): 18,814
Total clusters: 28332
Noise sequences (cluster -1): 35,382

================================================================================
1. ACCURACY AT TAXONOMIC LEVELS
================================================================================

DOMAIN Level:
  Total sequences evaluated: 62,631
  Correct predictions: 62,301
  Incorrect predictions: 330
  Accuracy: 99.47%

KINGDOM Level:
  Total sequences evaluated: 62,190
  Correct predictions: 56,631
  Incorrect predictions: 5,559
  Accuracy: 91.06%

PHYLUM Level:
  Total sequences evaluated: 61,994
  Correct predictions: 53,916
  Incorrect predictions: 8,078
  Accuracy: 86.97%

CLASS Level:
  Total sequences evaluated: 62,066
  Correct predictions: 50,555
  Incorrect predictions: 11,511
  Accuracy: 81.45%

ORDER Level:
  Total sequences evaluated: 61,713
  Correct predictions: 38,195
  Incorrect predictions: 23,518
  Accuracy: 61.89%

FAMILY Level:
  Total sequences evaluated: 61,740
  Correct predictions: 35,301
  Incorrect predictions: 26,439
  Accuracy: 57.18%

GENUS Level:
  Total sequences evaluated: 70,763
  Correct predictions: 34,584
  Incorrect predictions: 36,179
  Accuracy: 48.87%

SPECIES Level:
  Total sequences evaluated: 70,763
  Correct predictions: 23,642
  Incorrect predictions: 47,121
  Accuracy: 33.41%

================================================================================
2. NOVELTY DETECTION PERFORMANCE
================================================================================

True Positives (Novel→Novel): 4,833
False Positives (Known→Novel): 30,718
True Negatives (Known→Known, correct genus): 34,584
False Negatives (Novel→Known): 13,981

Precision: 0.136
Recall: 0.257
F1-Score: 0.178
Accuracy: 0.328

================================================================================
3. CLUSTER QUALITY (TAXONOMIC PURITY)
================================================================================

Purity calculated at genus level
Clusters evaluated: 27300
Mean purity: 0.610
Median purity: 0.500
High purity clusters (>0.9): 7952
Medium purity clusters (0.7-0.9): 509
Low purity clusters (<0.7): 18839

================================================================================
4. MISCLASSIFICATION ANALYSIS
================================================================================

Analysis at genus level
Total sequences evaluated: 70,763
Total misclassified: 36,179
Misclassification rate: 51.13%

Top 10 misclassification patterns (Genus level):
  Cortinarius -> Phlegmacium: 36
  Phlegmacium -> Cortinarius: 29
  Cortinarius -> Calonarius: 18
  Thaxterogaster -> Cortinarius: 17
  Cortinarius -> Thaxterogaster: 17
  Aspergillus -> Penicillium: 14
  Cortinarius -> Inocybe: 12
  Phlegmacium -> Branchiura: 11
  Penicillium -> Aspergillus: 11
  Amblyomma -> Bothriocroton: 10

================================================================================
5. OVERALL ASSESSMENT
================================================================================

Genus Accuracy: 48.87%
Species Accuracy: 33.41%
Novelty Detection F1-Score: 0.178
Cluster Purity (Mean, Genus): 0.610

Overall Rating: POOR: Low performance, significant improvements needed

================================================================================
6. RECOMMENDATIONS
================================================================================

- Species accuracy is low. Check `master_evaluation_table.csv` for common errors.
- Tune novelty detection thresholds (identity_threshold_novel)
- Review False Positives (Known→Novel) and False Negatives (Novel→Known)
- Adjust clustering parameters (min_cluster_size, min_samples)
- Consider alternative distance metrics or dimensionality reduction
