================================================================================
ENHANCED EVALUATION REPORT
Ground Truth vs Predicted OTU Comparison (Multi-Level)
Using Shared taxonomy_parser.py for consistent parsing
Supports Multiple Ground Truth Files
================================================================================

GROUND TRUTH SOURCES
--------------------------------------------------------------------------------
Number of ground truth files: 4
  - ssu_accession_full_lineage.tsv
  - LSU_eukaryote_rRNA_accession_full_lineage.tsv
  - ITS_eukaryote_sequences_accession_full_lineage.tsv
  - 16S_ribosomal_RNA_accession_full_lineage.tsv

Records by source:
  ssu_accession_full_lineage.tsv: 7,951

DATASET OVERVIEW
--------------------------------------------------------------------------------
Total sequences: 8,784
Sequences with ground truth: 7,951
Sequences without ground truth (N/A): 833
Total clusters: 1883
Noise sequences (cluster -1): 3,445

================================================================================
1. ACCURACY AT TAXONOMIC LEVELS
================================================================================

DOMAIN Level:
  Total sequences evaluated: 4,270
  Correct predictions: 4,270
  Incorrect predictions: 0
  Accuracy: 100.00%

KINGDOM Level:
  Total sequences evaluated: 4,166
  Correct predictions: 3,918
  Incorrect predictions: 248
  Accuracy: 94.05%

PHYLUM Level:
  Total sequences evaluated: 4,069
  Correct predictions: 3,592
  Incorrect predictions: 477
  Accuracy: 88.28%

CLASS Level:
  Total sequences evaluated: 4,053
  Correct predictions: 3,366
  Incorrect predictions: 687
  Accuracy: 83.05%

ORDER Level:
  Total sequences evaluated: 4,022
  Correct predictions: 2,974
  Incorrect predictions: 1,048
  Accuracy: 73.94%

FAMILY Level:
  Total sequences evaluated: 4,154
  Correct predictions: 2,448
  Incorrect predictions: 1,706
  Accuracy: 58.93%

GENUS Level:
  Total sequences evaluated: 4,679
  Correct predictions: 2,637
  Incorrect predictions: 2,042
  Accuracy: 56.36%

SPECIES Level:
  Total sequences evaluated: 4,679
  Correct predictions: 1,741
  Incorrect predictions: 2,938
  Accuracy: 37.21%

================================================================================
2. NOVELTY DETECTION PERFORMANCE
================================================================================

True Positives (Novel→Novel): 173
False Positives (Known→Novel): 3,272
True Negatives (Known→Known, correct genus): 2,637
False Negatives (Novel→Known): 660

Precision: 0.050
Recall: 0.208
F1-Score: 0.081
Accuracy: 0.320

================================================================================
3. CLUSTER QUALITY (TAXONOMIC PURITY)
================================================================================

Purity calculated at genus level
Clusters evaluated: 1822
Mean purity: 0.664
Median purity: 0.500
High purity clusters (>0.9): 693
Medium purity clusters (0.7-0.9): 31
Low purity clusters (<0.7): 1098

================================================================================
4. MISCLASSIFICATION ANALYSIS
================================================================================

Analysis at genus level
Total sequences evaluated: 4,679
Total misclassified: 2,042
Misclassification rate: 43.64%

Top 10 misclassification patterns (Genus level):
  Pterygota -> Psiloderces: 6
  Loxophyllum -> Kentrophyllum: 5
  Pterygota -> Galathealinum: 4
  Chara -> Lamprothamnium: 3
  Nesticella -> Leclercera: 3
  Acropora -> Isopora: 3
  Strongylostoma -> Dochmiotrema: 3
  Chaetonotus -> Sporobolomyces: 3
  Kudoa -> Archaphanostoma: 3
  Paralamyctes -> Psiloderces: 3

================================================================================
5. OVERALL ASSESSMENT
================================================================================

Genus Accuracy: 56.36%
Species Accuracy: 37.21%
Novelty Detection F1-Score: 0.081
Cluster Purity (Mean, Genus): 0.664

Overall Rating: FAIR: Moderate performance, consider parameter tuning

================================================================================
6. RECOMMENDATIONS
================================================================================

- Species accuracy is low. Check `master_evaluation_table.csv` for common errors.
- Tune novelty detection thresholds (identity_threshold_novel)
- Review False Positives (Known→Novel) and False Negatives (Novel→Known)
- Adjust clustering parameters (min_cluster_size, min_samples)
- Consider alternative distance metrics or dimensionality reduction
