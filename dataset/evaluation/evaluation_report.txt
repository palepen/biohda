================================================================================
ENHANCED EVALUATION REPORT
Ground Truth vs Predicted OTU Comparison (Multi-Level)
Using Shared taxonomy_parser.py for consistent parsing
Supports Multiple Ground Truth Files
================================================================================

GROUND TRUTH SOURCES
--------------------------------------------------------------------------------
Number of ground truth files: 4
  - ssu_accession_full_lineage.tsv
  - LSU_eukaryote_rRNA_accession_full_lineage.tsv
  - ITS_eukaryote_sequences_accession_full_lineage.tsv
  - 16S_ribosomal_RNA_accession_full_lineage.tsv

Records by source:
  ITS_eukaryote_sequences_accession_full_lineage.tsv: 65,678
  16S_ribosomal_RNA_accession_full_lineage.tsv: 21,278
  ssu_accession_full_lineage.tsv: 7,951
  LSU_eukaryote_rRNA_accession_full_lineage.tsv: 6,574

DATASET OVERVIEW
--------------------------------------------------------------------------------
Total sequences: 120,295
Sequences with ground truth: 101,481
Sequences without ground truth (N/A): 18,814
Total clusters: 27664
Noise sequences (cluster -1): 40,097

================================================================================
1. ACCURACY AT TAXONOMIC LEVELS
================================================================================

DOMAIN Level:
  Total sequences evaluated: 58,978
  Correct predictions: 58,862
  Incorrect predictions: 116
  Accuracy: 99.80%

KINGDOM Level:
  Total sequences evaluated: 58,521
  Correct predictions: 54,230
  Incorrect predictions: 4,291
  Accuracy: 92.67%

PHYLUM Level:
  Total sequences evaluated: 58,440
  Correct predictions: 51,760
  Incorrect predictions: 6,680
  Accuracy: 88.57%

CLASS Level:
  Total sequences evaluated: 58,356
  Correct predictions: 48,495
  Incorrect predictions: 9,861
  Accuracy: 83.10%

ORDER Level:
  Total sequences evaluated: 58,086
  Correct predictions: 37,107
  Incorrect predictions: 20,979
  Accuracy: 63.88%

FAMILY Level:
  Total sequences evaluated: 58,118
  Correct predictions: 34,191
  Incorrect predictions: 23,927
  Accuracy: 58.83%

GENUS Level:
  Total sequences evaluated: 66,571
  Correct predictions: 33,558
  Incorrect predictions: 33,013
  Accuracy: 50.41%

SPECIES Level:
  Total sequences evaluated: 66,571
  Correct predictions: 23,191
  Incorrect predictions: 43,380
  Accuracy: 34.84%

================================================================================
2. NOVELTY DETECTION PERFORMANCE
================================================================================

True Positives (Novel→Novel): 5,355
False Positives (Known→Novel): 34,910
True Negatives (Known→Known, correct genus): 33,558
False Negatives (Novel→Known): 13,459

Precision: 0.133
Recall: 0.285
F1-Score: 0.181
Accuracy: 0.323

================================================================================
3. CLUSTER QUALITY (TAXONOMIC PURITY)
================================================================================

Purity calculated at genus level
Clusters evaluated: 26652
Mean purity: 0.623
Median purity: 0.500
High purity clusters (>0.9): 8264
Medium purity clusters (0.7-0.9): 425
Low purity clusters (<0.7): 17963

================================================================================
4. MISCLASSIFICATION ANALYSIS
================================================================================

Analysis at genus level
Total sequences evaluated: 66,571
Total misclassified: 33,013
Misclassification rate: 49.59%

Top 10 misclassification patterns (Genus level):
  Phlegmacium -> Cortinarius: 27
  Amblyomma -> Bothriocroton: 19
  Penicillium -> Aspergillus: 18
  Cortinarius -> Phlegmacium: 18
  Cortinarius -> Thaxterogaster: 17
  Aspergillus -> Penicillium: 15
  Cortinarius -> Calonarius: 14
  Digenea -> Pterygota: 12
  Inocybe -> Cortinarius: 12
  Thaxterogaster -> Cortinarius: 10

================================================================================
5. OVERALL ASSESSMENT
================================================================================

Genus Accuracy: 50.41%
Species Accuracy: 34.84%
Novelty Detection F1-Score: 0.181
Cluster Purity (Mean, Genus): 0.623

Overall Rating: FAIR: Moderate performance, consider parameter tuning

================================================================================
6. RECOMMENDATIONS
================================================================================

- Species accuracy is low. Check `master_evaluation_table.csv` for common errors.
- Tune novelty detection thresholds (identity_threshold_novel)
- Review False Positives (Known→Novel) and False Negatives (Novel→Known)
- Adjust clustering parameters (min_cluster_size, min_samples)
- Consider alternative distance metrics or dimensionality reduction
